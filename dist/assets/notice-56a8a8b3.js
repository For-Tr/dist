import{j as G,J as v,d as H,b as h,A as b,l as P,r as i,o as A,e as S,f as m,n as a,y as c,C as R,z as Q,g as l,m as r,p as W,h as X}from"./index-da835352.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Z=async s=>G({url:"/CSAA/admin/notice/list",params:s,data:{},headers:{}}),ee=async s=>v({url:"/CSAA/admin/notice/create",params:{},data:s,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),te=async(s,u)=>v({url:"/CSAA/admin/notice/update",params:s,data:u,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),I=async s=>v({url:"/CSAA/admin/notice/delete",params:s,headers:{}}),oe=s=>(W("data-v-476bd603"),s=s(),X(),s),ne={class:"page-view"},ae={class:"table-operations"},le={key:0},se=["onClick"],ie=oe(()=>m("a",{href:"#"},"删除",-1)),ce=H({__name:"notice",setup(s){const u=h([{title:"序号",dataIndex:"index",key:"index",align:"center"},{title:"标题",dataIndex:"title",key:"title",align:"center"},{title:"内容",dataIndex:"content",key:"content",align:"center",customRender:({text:e,record:t,index:p,column:w})=>(e==null?void 0:e.substring(0,20))+"..."},{title:"操作",dataIndex:"action",key:"operation",align:"center",fixed:"right",width:140}]),n=h({noticeList:[],loading:!1,keyword:"",selectedRowKeys:[],pageSize:10,page:1}),o=h({visile:!1,editFlag:!1,title:"",form:{id:void 0,title:void 0},rules:{title:[{required:!0,message:"请输入",trigger:"change"}]}}),f=b();P(()=>{_()});const _=()=>{n.loading=!0,Z({keyword:n.keyword}).then(e=>{n.loading=!1,console.log(e),e.data.forEach((t,p)=>{t.index=p+1}),n.noticeList=e.data,n.loading=!1}).catch(e=>{n.loading=!1,console.log(e)})},z=b({onChange:(e,t)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",t),n.selectedRowKeys=e}}),K=()=>{y(),o.visile=!0,o.editFlag=!1,o.title="新增";for(const e in o.form)o.form[e]=void 0},F=e=>{y(),o.visile=!0,o.editFlag=!0,o.title="编辑";for(const t in o.form)o.form[t]=void 0;for(const t in e)o.form[t]=e[t]},B=e=>{console.log("delete",e),I({ids:e.id}).then(t=>{_()}).catch(t=>{r.error(t.msg||"操作失败")})},L=()=>{if(console.log(n.selectedRowKeys),n.selectedRowKeys.length<=0){console.log("hello"),r.warn("请勾选删除项");return}I({ids:n.selectedRowKeys.join(",")}).then(e=>{r.success("删除成功"),n.selectedRowKeys=[],_()}).catch(e=>{r.error(e.msg||"操作失败")})},N=()=>{var e;(e=f.value)==null||e.validate().then(()=>{o.editFlag?te({id:o.form.id},o.form).then(t=>{g(),_()}).catch(t=>{console.log(t),r.error(t.msg||"操作失败")}):ee(o.form).then(t=>{g(),_()}).catch(t=>{console.log(t),r.error(t.msg||"操作失败")})}).catch(t=>{console.log("不能为空")})},T=()=>{g()},y=()=>{var e;(e=f.value)==null||e.resetFields()},g=()=>{o.visile=!1};return(e,t)=>{const p=i("a-button"),w=i("a-space"),V=i("a-divider"),$=i("a-popconfirm"),D=i("a-table"),E=i("a-input"),k=i("a-form-item"),C=i("a-col"),M=i("a-textarea"),j=i("a-row"),O=i("a-form"),U=i("a-modal");return A(),S("div",null,[m("div",ne,[m("div",ae,[a(w,null,{default:c(()=>[a(p,{type:"primary",onClick:K},{default:c(()=>[R("新增")]),_:1}),a(p,{onClick:L},{default:c(()=>[R("批量删除")]),_:1})]),_:1})]),a(D,{size:"middle",rowKey:"id",loading:l(n).loading,columns:l(u),"data-source":l(n).noticeList,scroll:{x:"max-content"},"row-selection":l(z),pagination:{size:"default",current:l(n).page,pageSize:l(n).pageSize,onChange:d=>l(n).page=d,showSizeChanger:!1,showTotal:d=>`共${d}条数据`}},{bodyCell:c(({text:d,record:x,index:de,column:q})=>[q.key==="operation"?(A(),S("span",le,[m("a",{onClick:J=>F(x)},"编辑",8,se),a(V,{type:"vertical"}),a($,{title:"确定删除?","ok-text":"是","cancel-text":"否",onConfirm:J=>B(x)},{default:c(()=>[ie]),_:2},1032,["onConfirm"])])):Q("",!0)]),_:1},8,["loading","columns","data-source","row-selection","pagination"])]),m("div",null,[a(U,{visible:l(o).visile,forceRender:!0,title:l(o).title,"ok-text":"确认","cancel-text":"取消",onCancel:T,onOk:N},{default:c(()=>[m("div",null,[a(O,{ref_key:"myform",ref:f,"label-col":{style:{width:"80px"}},model:l(o).form,rules:l(o).rules},{default:c(()=>[a(j,{gutter:24},{default:c(()=>[a(C,{span:"24"},{default:c(()=>[a(k,{label:"标题",name:"title"},{default:c(()=>[a(E,{placeholder:"请输入标题",value:l(o).form.title,"onUpdate:value":t[0]||(t[0]=d=>l(o).form.title=d)},null,8,["value"])]),_:1})]),_:1}),a(C,{span:"24"},{default:c(()=>[a(k,{label:"通知内容",name:"content"},{default:c(()=>[a(M,{placeholder:"请输入内容",rows:4,value:l(o).form.content,"onUpdate:value":t[1]||(t[1]=d=>l(o).form.content=d)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["visible","title"])])])}}});const _e=Y(ce,[["__scopeId","data-v-476bd603"]]);export{_e as default};
