import{H as K}from"./header-ca487dae.js";import{F}from"./footer-597ca35d.js";import{j as z,a as L,u as U,k as V,b as B,l as H,B as N,r as _,o as i,e as d,f as a,n as g,g as o,F as S,q as k,s as T,t as D,x as R,y as E,z as P,p as q,h as j}from"./index-da835352.js";import{l as M}from"./thing-a049f12c.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";import"./k-logo-b1d5237f.js";import"./avatar-4ee3f7af.js";const O=async l=>z({url:"/CSAA/index/classification/list",params:l,data:{},headers:{}}),X=async l=>z({url:"/CSAA/index/tag/list",params:l,data:{},headers:{}});const w=l=>(q("data-v-f2f7ce80"),l=l(),j(),l),G={class:"content"},J={class:"content-left"},Q={class:"left-search-item"},W=w(()=>a("h4",null,"Category",-1)),Y={class:"left-search-item"},Z=w(()=>a("h4",null,"Class Room",-1)),ee={class:"tag-view tag-flex-view"},te=["onClick"],se={class:"content-right"},ae={class:"top-select-view flex-view"},oe={class:"order-view"},ne=w(()=>a("span",{class:"title"},null,-1)),ce=["onClick"],le={class:"pc-thing-list flex-view"},ie=["onClick"],de={class:"img-view"},re=["src"],_e={class:"info-view"},ge={class:"thing-name"},pe={key:0,class:"no-data",style:{}},he={class:"page-view",style:{}},ue={__name:"content",setup(l){L();const u=U(),C=V(),e=B({selectX:0,selectTagId:-1,cData:[],selectedKeys:[],tagData:[],loading:!1,tabData:["Newest","Hotest(St2/3)","Recommend(St2/3)"],selectTabIndex:0,tabUnderLeft:12,thingData:[],pageData:[],page:1,total:0,pageSize:12});H(()=>{b(),h({})});const b=()=>{e.cData.push({key:"-1",title:"All"}),O().then(t=>{t.data.forEach(s=>{s.key=s.id,e.cData.push(s)})}),X().then(t=>{e.tagData=t.data})},f=()=>e.selectedKeys.length>0?e.selectedKeys[0]:-1,m=t=>{e.selectedKeys=t,console.log(e.selectedKeys[0]),e.selectedKeys.length>0&&h({c:f()}),e.selectTagId=-1},v=t=>{e.selectedKeys=[],e.selectTagId=t,h({tag:e.selectTagId})},y=t=>{e.selectTabIndex=t,e.tabUnderLeft=12+50*t,console.log(e.selectTabIndex);const c={sort:t===0?"recent":t===1?"hot":"recommend"};e.selectTagId!==-1?c.tag=e.selectTagId:c.c=f(),h(c)},x=t=>{e.page=t;let s=(e.page-1)*e.pageSize;e.pageData=e.thingData.slice(s,s+e.pageSize),console.log("第"+e.page+"页")},h=t=>{e.loading=!0,M(t).then(s=>{e.loading=!1,s.data.forEach((r,I)=>{r.cover&&(r.cover=N+r.cover)}),console.log(s);let c=new Set;e.thingData=s.data.filter(r=>c.has(r.title)?!1:(c.add(r.title),!0)),e.total=e.thingData.length,x(1)}).catch(s=>{console.log(s),e.loading=!1})},A=t=>{const s=t.title;if(C.name==="search")u.push({name:"search",query:{keyword:s}});else{let c=u.resolve({name:"search",query:{keyword:s}});window.open(c.href,"_blank")}};return(t,s)=>{const c=_("a-tree"),r=_("a-spin"),I=_("a-pagination");return i(),d("div",G,[a("div",J,[a("div",Q,[W,g(c,{"tree-data":o(e).cData,"selected-keys":o(e).selectedKeys,onSelect:m,style:{"min-height":"220px"}},null,8,["tree-data","selected-keys"])]),a("div",Y,[Z,a("div",ee,[(i(!0),d(S,null,k(o(e).tagData,n=>(i(),d("span",{class:T(["tag",{"tag-select":o(e).selectTagId===n.id}]),key:n.id,onClick:p=>v(n.id)},D(n.title),11,te))),128))])])]),a("div",se,[a("div",ae,[a("div",oe,[ne,(i(!0),d(S,null,k(o(e).tabData,(n,p)=>(i(),d("span",{class:T(["tab",o(e).selectTabIndex===p?"tab-select":""]),key:p,onClick:Se=>y(p)},D(n),11,ce))),128)),a("span",{style:R({left:o(e).tabUnderLeft+"px"}),class:"tab-underline"},null,4)])]),g(r,{spinning:o(e).loading,style:{"min-height":"200px"}},{default:E(()=>[a("div",le,[(i(!0),d(S,null,k(o(e).pageData,n=>(i(),d("div",{key:n.id,onClick:p=>A(n),class:"thing-item item-column-3"},[a("div",de,[a("img",{src:n.cover},null,8,re)]),a("div",_e,[a("h3",ge,D(n.title.substring(0,12)),1)])],8,ie))),128)),o(e).pageData.length<=0&&!o(e).loading?(i(),d("div",pe,"No Data")):P("",!0)])]),_:1},8,["spinning"]),a("div",he,[g(I,{modelValue:o(e).page,"onUpdate:modelValue":s[0]||(s[0]=n=>o(e).page=n),size:"small",onChange:x,hideOnSinglePage:!0,defaultPageSize:o(e).pageSize,total:o(e).total,showSizeChanger:!1},null,8,["modelValue","defaultPageSize","total"])])])])}}},fe=$(ue,[["__scopeId","data-v-f2f7ce80"]]),me={components:{Footer:F,Header:K,Content:fe},data(){return{}}},ve={class:"portal"};function ye(l,u,C,e,b,f){const m=_("Header"),v=_("Content"),y=_("Footer");return i(),d("div",ve,[g(m),g(v),g(y)])}const Te=$(me,[["render",ye]]);export{Te as default};
